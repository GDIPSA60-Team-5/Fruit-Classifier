# Fruit Image Classifier

This repository contains the code and resources for a Convolutional Neural Network (CNN) based fruit image classifier. The project aims to accurately classify fruit images into four categories: **Apple, Banana, Orange, and Mixed**.

## Project Overview

Our primary goal was to develop a robust CNN model capable of achieving a test accuracy of at least 92% on a dataset of fruit images, specifically addressing challenges like class imbalance and overfitting, particularly for the "Mixed" fruit category.

The project involved a comprehensive approach, from initial data analysis and preprocessing to extensive model tuning and architecture exploration. We started with a baseline 2-layer CNN and progressively moved towards more sophisticated custom residual networks.

## Key Features

  * **Data Cleaning & Balancing:** Implemented strategies to clean mislabeled images and balance the dataset, especially for the underrepresented `Mixed` class.
  * **Data Augmentation:** Applied various augmentation techniques (rotation, horizontal flip, zoom, color jitter) to enhance model generalization and prevent overfitting.
  * **Custom CNN Architectures:** Developed and evaluated custom 3-layer CNNs and residual networks (Custom ResNet-8) trained from scratch.
  * **Hyperparameter Tuning:** Systematically optimized key hyperparameters such as image size, learning rate, and batch size for improved performance and stability.
  * **Performance Analysis:** Detailed evaluation of model performance using accuracy metrics, learning curves, and confusion matrices.

## Project Structure

```
.
├── CA_ResNet-18.ipynb                
├── CA_ResNet-8.ipynb                 
├── README.md                         # Project overview and instructions
├── ResNet-18_0.9333_Records/         # Saved training logs/results for ResNet-18 with 93.33% accuracy
├── ResNet-8_0.9333_Records/          # Saved training logs/results for ResNet-8 with 93.33% accuracy
├── test/                             # Test dataset directory
│   ├── 0/                            # apple
│   ├── 1/                            # banana
│   ├── 2/                            # orange
│   └── 3/                            # mixed
├── train/                            # Training dataset directory
```

## Getting Started

To get a copy of the project up and running on your local machine, follow these steps.

### Prerequisites

  * Python 3.x
  * `pip` (Python package installer)

### Installation

1.  **Clone the repository:**
    ```bash
    git clone https://github.com/GDIPSA60-Team-5/Fruit-Classifier.git
    cd Fruit-Classifier
    ```
2.  **Create a virtual environment (recommended):**
    ```bash
    python -m venv venv
    source venv/bin/activate  # On Windows: `venv\Scripts\activate`
    ```
3.  **Install dependencies:**
    ```bash
    pip install -r requirements.txt
    ```
    *Note: A `requirements.txt` file would typically be generated by running `pip freeze > requirements.txt` after installing all necessary libraries.*

### Dataset

The dataset is structured into `train` and `test` directories, each containing subdirectories for `Apple`, `Banana`, `Orange`, and `Mixed` fruit images. Ensure your dataset adheres to this structure.

### Running the Model

To train and evaluate the model, execute the `fruit_classifier.py` script:

```bash
python fruit_classifier.py
```

This script will perform data loading, preprocessing (including cleaning and augmentation), model training, and evaluation. You can modify the `fruit_classifier.py` to experiment with different model architectures or hyperparameters.

## Results

Our best-performing model, the **Custom ResNet-8 CNN**, achieved a test accuracy of **93.33%**. This model demonstrated excellent generalization capabilities, particularly for the challenging `Mixed` class, and balanced performance with computational efficiency.

For a detailed analysis of the experiments, architectural decisions, and performance metrics, please refer to the full project report: [Fruit Image Classifier Report.pdf](https://www.google.com/search?q=Fruit_Image_Classifier_Report.pdf).

-----

## Appendix & Further Details

For more in-depth information, including detailed training logs, configuration variations, and comprehensive experimental results, please check the following resources:

  * **Detailed Training Logs:** [ML CA Training Document.xlsx](https://nusu-my.sharepoint.com/:x:/g/personal/e1505293_u_nus_edu/ET27ONUOThdEkbEY2fCtI_cBndHgL46WP4fQZYzunj0biA?e=LJiliF)
  * **Full Codebase:** [GitHub Repository — Fruit Classifier (Team 5)](https://github.com/GDIPSA60-Team-5/Fruit-Classifier/tree/main)

-----

## Contributing

We welcome contributions\! If you have suggestions for improvements or new features, feel free to open an issue or submit a pull request.

## License

This project is licensed under the MIT License. See the `LICENSE` file for details.

-----

## Acknowledgments

  * National University of Singapore (NUS) - SA4110 Machine Learning Course
  * Team 5 Members:
      * PHYO NYI NYI PAING
      * MUHAMMAD HAZIQ BIN JAMIL
      * ZHANG RUI
      * HUANG JING JIA
      * AUNG MYIN MOE
      * LI XING BANG
